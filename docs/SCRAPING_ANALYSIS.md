# 다이소 스크래핑 가능성 분석

## 조사 목표

1. ✅ 실제 API 엔드포인트 파악
2. ✅ HTTP 요청만으로 데이터 수집 가능한지 확인
3. ✅ Puppeteer 없이 구현 가능한지 검증
4. ✅ 수집 가능한 데이터 유형 정리

---

## 테스트 결과

### 1. 다이소 공식 홈페이지 (daiso.co.kr)

#### 매장 검색 API

**엔드포인트**: `https://www.daiso.co.kr/cs/ajax/shop_search`

**테스트 결과**: ❌ **실패**
- POST 요청 시 HTML 페이지 반환 (API 응답 아님)
- 세션 또는 특별한 인증 필요로 추정
- CSRF 토큰 또는 쿠키 기반 인증 가능성

**파라미터**:
```
- name_address: 매장명 검색어
- sido: 시/도
- gugun: 시/군/구
- dong: 읍/면/동
- opt_search: 편의시설 필터
```

**문제점**:
- 직접 HTTP 요청으로는 JSON 응답을 받을 수 없음
- 웹 브라우저 세션이 필요할 가능성

#### 시도/시군구 검색 API

**엔드포인트**:
- `https://www.daiso.co.kr/cs/ajax/sido_search`
- `https://www.daiso.co.kr/cs/ajax/gugun_search`

**테스트 결과**: ⚠️ **부분 성공**
- GET 요청 시 빈 배열 `[]` 반환
- 올바른 파라미터 전달 시 작동 가능성 있음
- 추가 헤더/쿠키 필요 가능성

### 2. 다이소몰 (daisomall.co.kr)

**구조**: Nuxt.js 기반 SPA (Single Page Application)

#### 테스트한 API 엔드포인트

| 엔드포인트 | 결과 | 비고 |
|-----------|------|------|
| `/api/exhibition/prd/main` | 404 | 존재하지 않음 |
| `/api/product/list` | 404 | 존재하지 않음 |
| `/shop/search_result.php` | 404 | 존재하지 않음 |

**문제점**:
- Nuxt.js SPA는 클라이언트 사이드에서 데이터를 동적으로 로드
- 실제 API 엔드포인트는 JavaScript 번들 내부에 숨겨져 있음
- 브라우저 개발자 도구의 Network 탭 분석 필요

---

## 스크래핑 가능성 평가

### ❌ 다이소 공식 홈페이지 - 어려움

**이유**:
1. 세션 기반 인증 필요
2. CSRF 토큰 가능성
3. 단순 HTTP 요청으로는 데이터 수집 불가
4. **Puppeteer 필요**

**대안**:
- Puppeteer/Playwright로 브라우저 자동화
- Cloudflare Workers에서는 사용 불가 (브라우저 환경 필요)

### ❌ 다이소몰 - 매우 어려움

**이유**:
1. robots.txt에서 크롤링 명시적 차단
2. Nuxt.js SPA로 구현되어 JavaScript 실행 필수
3. API 엔드포인트가 공개되지 않음
4. **브라우저 없이는 데이터 수집 불가능**

**대안**:
- 브라우저 자동화 도구 필수
- Cloudflare Workers에서는 구현 불가

---

## 수집 가능한 데이터 유형 (이론상)

만약 브라우저 자동화를 사용한다면:

### 1. 매장 정보
- 매장명
- 주소
- 전화번호
- 영업시간
- 위도/경도 (Kakao Map 좌표)
- 편의시설 (주차, 엘리베이터 등)
- 서비스 (현금없는매장, 스티커 등)

### 2. 제품 정보 (다이소몰)
- 제품명
- 가격
- 카테고리
- 이미지 URL
- 제품 설명
- 재고 상태
- 할인 정보

---

## Puppeteer 없이 가능한가?

### 결론: ❌ **불가능**

**이유**:

1. **세션/인증 문제**
   - 다이소 API는 브라우저 세션 필요
   - 쿠키, CSRF 토큰 등 관리 복잡

2. **JavaScript 실행 필요**
   - 다이소몰은 Nuxt.js SPA
   - 서버 사이드에서 HTML만 받아서는 데이터 없음
   - 클라이언트에서 JavaScript 실행 후 데이터 로드

3. **Cloudflare Workers 제약**
   - Workers는 서버리스 환경
   - 브라우저 자동화 도구 사용 불가
   - Puppeteer/Playwright 실행 불가

---

## 대안 방안

### 방안 1: 외부 스크래핑 서비스 사용

**구조**:
```
Cloudflare Workers → 외부 스크래핑 서비스 → 다이소 웹사이트
                          ↓
                      캐시된 데이터
```

**외부 서비스**:
- Apify
- ScrapingBee
- Browserless
- 자체 서버에서 Puppeteer 실행

**비용**: 유료 서비스 필요

### 방안 2: 정적 데이터베이스 구축

**방법**:
- 주기적으로 로컬에서 Puppeteer 실행
- 데이터를 Cloudflare D1/KV에 저장
- Workers에서 저장된 데이터 제공

**장점**:
- Workers에서 빠른 응답
- 스크래핑 부하 분산

**단점**:
- 실시간 데이터 아님
- 별도 스크래핑 인프라 필요

### 방안 3: 공식 API 제휴 (권장)

**방법**:
- 다이소에 공식 API 제공 요청
- 비즈니스 제휴 협의

**연락처**:
- webmaster@daiso.co.kr
- 1522-4400

### 방안 4: 목업 데이터 유지 (현재)

**장점**:
- 가장 안전하고 합법적
- 법적 문제 없음
- 구현 간단

**단점**:
- 실제 데이터 아님
- 제한적인 기능

---

## 최종 권장사항

### ✅ 단기 (현재)
**목업 데이터 사용**
- 현재 구현 상태 유지
- 다이소 공식 사이트 링크 제공
- 법적으로 안전

### ✅ 중기 (1-3개월)
**공식 제휴 시도**
- 다이소에 API 제공 문의 이메일 발송
- 비즈니스 가치 제안
- 협의 진행

### ⚠️ 장기 (필요시)
**하이브리드 접근**
- 공식 제휴 실패 시
- 외부 스크래핑 서비스 고려
- 정적 데이터베이스 구축

---

## 기술적 제약 요약

| 항목 | HTTP Only | Puppeteer | 비고 |
|------|-----------|-----------|------|
| 다이소 매장 검색 | ❌ | ✅ | 세션 필요 |
| 다이소몰 제품 | ❌ | ✅ | SPA, JS 실행 필요 |
| Cloudflare Workers | ✅ | ❌ | 브라우저 환경 없음 |
| 로컬/서버 환경 | ✅ | ✅ | 모두 가능 |

---

## 결론

**Puppeteer 없이 다이소 데이터 스크래핑은 불가능합니다.**

Cloudflare Workers 환경에서는 브라우저 자동화 도구를 실행할 수 없으므로, 실제 다이소 데이터를 얻으려면:

1. **공식 API 제휴** (최우선)
2. **외부 스크래핑 서비스 사용**
3. **별도 서버에서 스크래핑 후 데이터 저장**

현재는 **목업 데이터를 유지**하는 것이 가장 안전하고 합법적인 방법입니다.
